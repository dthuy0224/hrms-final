<!DOCTYPE html>
<html>
    <%- include('../partials/header') %>

    <body>
        <nav class="navbar navbar-default no-margin">
            <!-- Brand and toggle get grouped for better mobile display -->

            <div class="navbar-header fixed-brand">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" id="menu-toggle">
                    <span class="glyphicon glyphicon-th-large" style="margin-left: 5px" aria-hidden="true"></span>
                </button>
                <a class="navbar-brand" href="#"><i class="fa fa-a fa-4"></i>
                    <%= userName %>
                </a>
            </div>
            <!-- navbar-header-->

            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <button class="navbar-toggle collapse in" data-toggle="collapse" id="menu-toggle-2">
                            <span class="glyphicon glyphicon-th-large" aria-hidden="true"></span>
                        </button>
                    </li>
                    <li class="navbar-brand">
                        <form action="/logout" method="get">
                            <button id="logout" type="submit" style="margin-top: -3px" class="btn btn-default">
                                <i class="fa fa-user" aria-hidden="true"></i> Logout
                            </button>
                        </form>
                    </li>
                </ul>
            </div>
            <!-- bs-example-navbar-collapse-1 -->
        </nav>
        <div id="wrapper">
            <!-- Include the sidebar partial -->
            <%- include('../partials/employee_sidebar') %>
            
            <!-- Page Content -->
            <div id="page-content-wrapper">
                <div class="container-fluid xyz">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="page-header">
                                <ol class="breadcrumb">
                                    <li><a href="/employee/dashboard">Dashboard</a></li>
                                    <li class="active">Profile</li>
                                </ol>
                                <h3 style="margin-top: 5px; margin-bottom: 10px;"><i class="fa fa-angle-right"></i> My Profile</h3>
                            </div>

                            <div class="profile-container" style="margin-top: -5px;">
                                <div class="row">
                                    <!-- Left side profile card -->
                                    <div class="col-md-4">
                                        <div class="profile-card">
                                            <div class="profile-header" style="background-color: #222;">
                                                <div class="employment-badge">
                                                    <% if (employee.employeeType) { %>
                                                        <%= employee.employeeType %>
                                                    <% } else if (employee.employmentType) { %>
                                                        <%= employee.employmentType === 'full-time' ? 'Full-Time' : 'Part-Time' %>
                                                    <% } else { %>
                                                        Full-time
                                                    <% } %>
                                                </div>
                                            </div>
                                            <div class="profile-body text-center">
                                                <div class="profile-image">
                                                    <% if(employee.photo) { %>
                                                        <img src="/uploads/<%= employee.photo %>" alt="<%= employee.name %>" class="img-circle">
                                                    <% } else { %>
                                                        <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Default Avatar" class="img-circle">
                                                    <% } %>
                                                </div>
                                                <h3 class="profile-name"><%= employee.name %></h3>
                                                <p class="profile-id">@<%= employee.jobId || (employee._id.toString().substr(-2)) %></p>
                                                
                                                <hr>
                                                
                                                <div class="profile-details">
                                                    <p>
                                                        <i class="fa fa-briefcase"></i> 
                                                        <%= employee.designation || "UI Designer" %>
                                                    </p>
                                                    <p>
                                                        <i class="fa fa-building"></i> 
                                                        Working at: <%= employee.department || 'IT Department' %>
                                                    </p>
                                                    <p>
                                                        <i class="fa fa-envelope"></i> 
                                                        <%= employee.personalEmail || employee.email %>
                                                    </p>
                                                    <p>
                                                        <i class="fa fa-phone"></i> 
                                                        <%= employee.contactNumber || "0933387264" %>
                                                    </p>
                                                    <% if (employee.supervisor) { %>
                                                    <p>
                                                        <i class="fa fa-user"></i> 
                                                        Report by: <%= employee.supervisor %>
                                                    </p>
                                                    <% } %>
                                                    <p>
                                                        <i class="fa fa-calendar"></i> 
                                                        Birthday on: <%= moment(employee.dateOfBirth).format('DD MMMM') %>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Right side information panels -->
                                    <div class="col-md-8">
                                        <div class="row mb-4">
                                            <div class="col-md-6">
                                                <div class="info-box">
                                                    <div class="info-box-icon">
                                                        <i class="fa fa-calendar-check-o"></i>
                                                    </div>
                                                    <div class="info-box-content">
                                                        <h4>Start Date</h4>
                                                        <p><%= employee.startDate ? moment(employee.startDate).format('DD MMMM YYYY') : '20 April 2021' %></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="info-box">
                                                    <div class="info-box-icon">
                                                        <i class="fa fa-birthday-cake"></i>
                                                    </div>
                                                    <div class="info-box-content">
                                                        <h4>Date of Birth</h4>
                                                        <p><%= moment(employee.dateOfBirth).format('DD MMMM YYYY') %></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Personal Information Panel -->
                                        <div class="panel panel-info">
                                            <div class="panel-heading">
                                                <h3 class="panel-title">Personal information</h3>
                                            </div>
                                            <div class="panel-body">
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Name:</strong></div>
                                                    <div class="col-md-9"><%= employee.name %></div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Gender:</strong></div>
                                                    <div class="col-md-9">
                                                        <%= employee.gender ? (employee.gender.charAt(0).toUpperCase() + employee.gender.slice(1)) : 'Female' %>
                                                    </div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Birthplace:</strong></div>
                                                    <div class="col-md-9"><%= employee.birthplace || 'Hanoi' %></div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Address:</strong></div>
                                                    <div class="col-md-9">
                                                        <% if (employee.detailedAddress || employee.district || employee.province) { %>
                                                            <%= [employee.detailedAddress, employee.district, employee.province].filter(Boolean).join(', ') %>
                                                        <% } else { %>
                                                            Nguyen Trai St, Trung Van Ward, Nam Tu Liem District, Hanoi
                                                        <% } %>
                                                    </div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>ID Number:</strong></div>
                                                    <div class="col-md-9"><%= employee.idNumber || '035304001786' %></div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Personal Email:</strong></div>
                                                    <div class="col-md-9"><%= employee.personalEmail || (employee.email.replace('@hrms.com', '@gmail.com')) %></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Job Information Panel -->
                                        <div class="panel panel-info">
                                            <div class="panel-heading">
                                                <h3 class="panel-title">Job information</h3>
                                            </div>
                                            <div class="panel-body">
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>ID:</strong></div>
                                                    <div class="col-md-9"><%= employee.jobId || '31' %></div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Job Title:</strong></div>
                                                    <div class="col-md-9"><%= employee.designation || "UI Designer" %></div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Department:</strong></div>
                                                    <div class="col-md-9"><%= employee.department || 'IT Department' %></div>
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Work Experience:</strong></div>
                                                    <div class="col-md-9"><%= employee.experience || 'Senior' %></div>
                                                </div>
                                                <% if (employee.Skills && employee.Skills.length > 0) { %>
                                                <div class="row mb-3">
                                                    <div class="col-md-3"><strong>Skills:</strong></div>
                                                    <div class="col-md-9">
                                                        <% employee.Skills.forEach(function(skill, index) { %>
                                                            <% if (skill !== "") { %>
                                                                <span class="badge badge-info"><%= skill %></span>
                                                            <% } %>
                                                        <% }); %>
                                                    </div>
                                                </div>
                                                <% } %>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /#page-content-wrapper -->
        </div>
        <!-- /#wrapper -->
        <!-- jQuery -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.js" charset="UTF-8"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.js" charset="UTF-8"></script>
        <script src="/javascripts/sidebar_menu.js"></script>
        
        <!-- CSS for profile page -->
        <style>
            /* Styles for profile page */
            .profile-container {
                margin-top: 20px;
            }
            .profile-card {
                border: 1px solid #ddd;
                border-radius: 5px;
                overflow: hidden;
                margin-bottom: 20px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
            .profile-header {
                height: 80px;
                position: relative;
            }
            .employment-badge {
                position: absolute;
                top: 10px;
                right: 10px;
                background-color: rgba(255,255,255,0.8);
                color: #333;
                padding: 5px 10px;
                border-radius: 3px;
                font-size: 12px;
                font-weight: bold;
            }
            .profile-body {
                padding: 20px;
                background-color: #f9f9f9;
            }
            .profile-image {
                position: relative;
                z-index: 2;
                text-align: center;
                margin-bottom: 15px;
            }
            .profile-image img {
                width: 120px;
                height: 120px;
                border: 5px solid white;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                margin-top: -60px;
                display: inline-block;
            }
            .profile-name {
                font-size: 24px;
                margin-bottom: 5px;
            }
            .profile-id {
                color: #666;
                margin-bottom: 15px;
            }
            .profile-details {
                text-align: left;
            }
            .profile-details p {
                margin-bottom: 10px;
            }
            .profile-details i {
                margin-right: 10px;
                width: 16px;
                color: #3498db;
            }
            .info-box {
                display: flex;
                background-color: #e8f4fc;
                border-radius: 5px;
                padding: 15px;
                margin-bottom: 20px;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            .info-box-icon {
                font-size: 24px;
                margin-right: 15px;
                color: #3498db;
            }
            .info-box-content h4 {
                margin-top: 0;
                margin-bottom: 5px;
                font-size: 16px;
                color: #555;
            }
            .info-box-content p {
                margin: 0;
                font-size: 16px;
                font-weight: bold;
            }
            .panel-info > .panel-heading {
                display: flex;
                justify-content: space-between;
                align-items: center;
                background-color: #d9edf7;
                color: #31708f;
            }
            .panel-title {
                margin: 0;
            }
            .btn-edit {
                padding: 2px 8px;
            }
            .row.mb-3 {
                margin-bottom: 15px;
            }
            .badge-info {
                background-color: #3498db;
                margin-right: 5px;
                padding: 5px 10px;
                border-radius: 3px;
                color: white;
                display: inline-block;
            }
            .page-header {
                margin-bottom: 20px;
            }
            .breadcrumb {
                background-color: #f8f8f8;
                padding: 8px 15px;
                margin-bottom: 10px;
                border-radius: 4px;
            }
            /* Additional styles to move content up */
            #page-content-wrapper {
                padding-top: 10px;
            }
            .page-header {
                margin-top: 10px;
                margin-bottom: 15px;
            }
            .panel {
                margin-bottom: 15px;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            .panel-heading {
                padding: 10px 15px;
            }
            .panel-body {
                padding: 15px;
            }
            .info-box {
                margin-bottom: 15px;
            }
        </style>
    </body>
    <div id="myModal2" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <form method="post" action="/employee/mark-employee-attendance">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">
                            &times;
                        </button>
                        <h4 class="modal-title">Mark Attendance</h4>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure you want to mark attendance.</p>
                    </div>
                    <div class="modal-footer">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                        <button type="reset" class="btn btn-default" data-dismiss="modal">
                            No
                        </button>
                        <button type="submit" class="btn btn-default">Yes</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <form method="post" action="/employee/view-attendance">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">
                            &times;
                        </button>
                        <h4 class="modal-title">Select Month/Year</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="Month">Month:</label>
                            <select class="form-control" id="month" name="month">
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="year">Year:</label>
                            <select class="form-control" id="year" name="year"></select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                        <button type="reset" class="btn btn-default" data-dismiss="modal">
                            Close
                        </button>
                        <button type="submit" class="btn btn-default">View</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

</html>